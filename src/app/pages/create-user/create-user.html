<div class="w-4/5 lg:w-2/3 mt-10 mx-auto card p-6 md:h-fit">
  <h2 class="text-2xl font-semibold mb-6">Create New User</h2>

  <form [formGroup]="userForm" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-gramm="false" data-lt-active="false">

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <!-- Full Name -->
      <div>
        <label class="block font-medium mb-1 text-slate-700">Full Name *</label>
         <input type="text" formControlName="full_name" autocomplete="off" data-gramm="false" data-lt-active="false"
           class="input"
           placeholder="John Doe">
        <div *ngIf="userForm.controls['full_name'].invalid && userForm.controls['full_name'].touched" class="text-red-600 text-sm mt-1">
          Full name is required.
        </div>
      </div>

      <!-- Email -->
      <div>
        <label class="block font-medium mb-1 text-slate-700">Email *</label>
         <input type="email" formControlName="email" autocomplete="off" data-gramm="false" data-lt-active="false"
           class="input"
           placeholder="user@example.com">
        <div *ngIf="userForm.controls['email'].invalid && userForm.controls['email'].touched" class="text-red-600 text-sm mt-1">
          Please enter a valid email.
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <!-- Role -->
      <div>
        <label class="block font-medium mb-1 text-slate-700">Role *</label>
        <select formControlName="role" class="select">
          <option value="super_admin">Super Admin</option>
          <option value="admin">Admin</option>
          <option value="voter">Voter</option>
        </select>
        <div *ngIf="userForm.controls['role'].invalid && userForm.controls['role'].touched" class="text-red-600 text-sm mt-1">
          Role is required.
        </div>
      </div>

      <!-- Phone -->
      <div>
        <label class="block font-medium mb-1 text-slate-700">Phone</label>
         <input type="tel" formControlName="phone" autocomplete="off" data-gramm="false" data-lt-active="false"
           class="input"
           placeholder="+1 555 555 5555">
        <div *ngIf="userForm.controls['phone'].invalid && userForm.controls['phone'].touched" class="text-red-600 text-sm mt-1">
          Please enter a valid phone number.
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 items-start">
      <!-- Profile Image Upload -->
      <div>
        <div *ngIf="previewUrl" class="mt-3">
          <div class="w-10 h-10 rounded-full overflow-hidden">
            <img [src]="previewUrl" alt="avatar preview" w-20 class="w-full h-full object-cover" />
          </div>
          <button type="button" class="mt-2 text-sm text-slate-600 underline" (click)="selectedImage = null; previewUrl = null;">Remove</button>
        </div>
        <label for="profimg" class="btn-ghost cursor-pointer mt-5">Select Image</label>
         <input type="file" id="profimg" hidden accept="image/*" autocomplete="off" data-gramm="false" data-lt-active="false"
           class="w-full p-1 border rounded-md" (change)="onImageSelected($event)" />

        <div class="text-xs text-slate-500 mt-2">Recommended: square image, between 128x128 and 800x800 px, max 2MB.</div>
      </div>

      <!-- Placeholder/details column (can add other settings) -->
      <div>
        <label class="block font-medium mb-1 text-slate-700">Notes</label>
        <textarea rows="4" class="textarea" placeholder="Optional note about the user" autocomplete="off" data-gramm="false" data-lt-active="false"></textarea>
      </div>
    </div>

    <!-- Submit -->
            <button type="submit" [disabled]="loading" [class.opacity-50]="loading"
              class="btn-accent w-full font-semibold disabled:cursor-not-allowed">
      {{ loading ? 'Creating User...' : 'Create User' }}
    </button>

  </form>
</div>
